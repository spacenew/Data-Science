# Отток клиентов  

## Описание задачи

По историческим данным о клиентах нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет.

Метрика качества - F1-мера. Значение должно быть не меньше 0.59.

## Данные 

- `RowNumber` — индекс строки в данных  
- `CustomerId` — уникальный идентификатор клиента  
- `Surname` — фамилия  
- `CreditScore` — кредитный рейтинг  
- `Geography` — страна проживания  
- `Gender` — пол  
- `Age` — возраст  
- `Tenure` — сколько лет человек является клиентом банка  
- `Balance` — баланс на счёте  
- `NumOfProducts` — количество продуктов банка, используемых клиентом  
- `HasCrCard` — наличие кредитной карты  
- `IsActiveMember` — активность клиента  
- `EstimatedSalary` — предполагаемая зарплата     

Целевой признак

- `Exited` — факт ухода клиента  

## ВЫВОДЫ:

Проверили предварительную обработку данных:
1. Проверили наличие дублей
2. Удалили лишние признаки
3. Преобразовали категориальные признаки методом One Hot Encoding
4. Отмасштабировали признаки методом StandardScaler
5. Разбили датасет на 3 выборки: тренировочную, валидационную, тестовую - в пропорции 3:1:1

Для оценки взяли 3 модели: DecisionTreeClassifier, RandomForestClassifier, LogisticRegression

Обучили модели c дисбалансом классов. Лучшие данные по метрике F1-мера получила модель RandomForest, c показателем ~ 0.57. 
Худший показатель у логистической регресии ~ 0.33

После применения стандартной балансировки классов (class_weight='balanced') получили прирост в значении целевой метрики по всем моделям. Особенно заметно увеличилась метрика на логистической регресии с 0.33 до 0.49  

Также применили такие методы как upsampling, downsampling, RandomOverSampler. Downsampling сильно снижал качество целевой метрики на "деревянных" моделях, поэтому было решено в дальнейшем его не использовать.  

Сравнили модели логистической регрессии, дерева решений и случайного леса с настроенными гиперпараметрами по сбалансированным выборкам (upsampling, RandomOverSampler). 
При использовании RandomOverSampler прироста метрики не было замечено.
Поиск лучших гиперпараметров производился с помощью поиска по сетке GridSearchCV.  

На тестовой выборке лучший результат метрики f1-score ~0.6 показала модель случайного леса при применении баланса классов(class_weight='balanced').


## Возможные улучшения:

1. Провести оценку влияния признаков на показатель целевой метрики, оставить признаки, которые вносят наибольший вклад, переобучить модель и рассчитать метрику f1-мера
2. Рассмотреть другие методы баланса классов для возможности увеличения качества метрики 
